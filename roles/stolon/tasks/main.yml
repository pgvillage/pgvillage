---
# tasks file for stolon
- name: Checking for valid certs config
  assert:
    that:
      - "'\n' in stolon_client_cert"
      - "'\n' in stolon_client_chain"
      - "'\n' in stolon_client_key"
      - "'\n' in stolon_server_cert"
      - "'\n' in stolon_server_key"
      - "'\n' in stolon_server_chain"
    fail_msg: "Please run chainsmith to succesfully setup certs"
    success_msg: "Client and server certs seem properly setup"

- getent:
    database: passwd
    key: "{{ stolon_user }}"
    split: ":"

- include_tasks: install.yml
  when: stolon_release | length > 0

- include_tasks: configure.yml
- include_tasks: certs.yml
- include_tasks: pglogging.yml

- include_tasks: start.yml
